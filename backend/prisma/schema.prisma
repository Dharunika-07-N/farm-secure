datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  password      String
  firstName     String
  lastName      String
  phone         String?
  role          Role      @default(FARMER)
  isVerified    Boolean   @default(false)
  avatarUrl     String?
  language      String    @default("en")
  address       String?
  jobTitle      String?   // e.g. "Senior Farmer", "Owner"
  
  // Notification Settings
  emailNotifications    Boolean   @default(true)
  smsNotifications      Boolean   @default(true)
  whatsappNotifications Boolean   @default(false)
  
  // Privacy Settings
  shareData             Boolean   @default(true)

  farms         Farm[]
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model Farm {
  id                 String        @id @default(uuid())
  name               String
  registrationNumber String?
  location           String
  latitude           Float?
  longitude          Float?
  size               Float
  sizeUnit           String        @default("acres")
  livestockType      String?       // "Poultry", "Pig", "Mixed"
  animalCount        Int?
  establishmentDate  DateTime?
  infrastructure     String?       // JSON string or text description for now
  description        String?
  imageUrl           String?
  userId             String
  user               User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  crops              Crop[]
  transactions       Transaction[]
  inventory          Inventory[]
  alerts             Alert[]
  compliance         Compliance[]
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
}

model Crop {
  id           String     @id @default(uuid())
  name         String
  variety      String?
  plantingDate DateTime
  harvestDate  DateTime?
  status       CropStatus @default(PLANTED)
  area         Float
  farmId       String
  farm         Farm       @relation(fields: [farmId], references: [id], onDelete: Cascade)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
}

model Transaction {
  id          String          @id @default(uuid())
  type        TransactionType
  category    String
  amount      Float
  description String?
  date        DateTime
  farmId      String
  farm        Farm            @relation(fields: [farmId], references: [id], onDelete: Cascade)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

model Inventory {
  id            String            @id @default(uuid())
  itemName      String
  quantity      Float
  unit          String
  category      InventoryCategory
  lowStockAlert Float?
  farmId        String
  farm          Farm              @relation(fields: [farmId], references: [id], onDelete: Cascade)
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
}


model Alert {
  id          String   @id @default(uuid())
  title       String
  description String
  type        String   
  isRead      Boolean  @default(false)
  createdAt   DateTime @default(now())
  farmId      String
  farm        Farm     @relation(fields: [farmId], references: [id], onDelete: Cascade)
}

model Compliance {
  id          String   @id @default(uuid())
  name        String   
  completed   Boolean  @default(false)
  date        DateTime @default(now())
  farmId      String
  farm        Farm     @relation(fields: [farmId], references: [id], onDelete: Cascade)
}

model Outbreak {
  id              String   @id @default(uuid())
  name            String
  type            String   // avian_influenza, african_swine_fever, etc.
  latitude        Float
  longitude       Float
  severity        String   // high, medium, low
  date            DateTime
  affectedAnimals Int
  riskRadius      Float    // in km
  createdAt       DateTime @default(now())
}

enum Role {
  ADMIN
  FARMER
  INSPECTOR
}

enum CropStatus {
  PLANTED
  GROWING
  HARVESTED
  FAILED
}

enum TransactionType {
  INCOME
  EXPENSE
}

enum InventoryCategory {
  SEEDS
  FERTILIZER
  PESTICIDE
  EQUIPMENT
  OTHER
}
